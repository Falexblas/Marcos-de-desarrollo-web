<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mi Carrito</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" type="image/png" href="img/programacion.png">
  <style>
    body {
      background-color: #0d1117;
      color: white;
    }
    .titulo {
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
      margin: 30px 0 20px;
    }
  </style>
</head>
<body>

<body style="background-color: #0d1117; color: white;">
  <nav class="navbar navbar-expand-lg bg-dark navbar-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="/index.html"> 
        <img src="/img/LOGO.png" alt="Logo" height="30">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
            
          <li class="nav-item"><a class="nav-link text-white" href="/index.html">Inicio</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="/Cursos.html">Cursos</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="/Nosotros.html">Nosotros</a></li>
          <li class="nav-item"><a class="nav-link text-white" href="#"><i class="bi bi-person"></i></a></li>
          <li class="nav-item"><a class="nav-link text-white" href="/carrito.html"><i class="bi bi-cart"></i></a></li>

        </ul>
      </div>
    </div>
  </nav>


  <div class="container">
    <div class="titulo">
      <h2>ðŸ›’ Mi Carrito</h2>
    </div>
    <div class="row" id="carritoContainer"></div>
    <div class="text-center mt-4">
      <h4>Total: <span id="totalPrecio">S/ 0</span></h4>
      <button class="btn btn-success mt-2">Finalizar compra</button>
    </div>
  </div>

  <script>
    let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
    const carritoContainer = document.getElementById("carritoContainer");
    const totalPrecio = document.getElementById("totalPrecio");

    function mostrarCarrito() {
      carritoContainer.innerHTML = "";
      let total = 0;

      // Agrupar por ID
      const agrupados = {};
      carrito.forEach(curso => {
        if (!agrupados[curso.id]) {
          agrupados[curso.id] = { ...curso, cantidad: 1 };
        } else {
          agrupados[curso.id].cantidad += 1;
        }
      });

      // Mostrar cada curso agrupado
      Object.values(agrupados).forEach(curso => {
        const card = document.createElement("div");
        card.className = "col-md-6 col-lg-4 mb-4";
        card.innerHTML = `
          <div class="card text-white bg-dark border-light h-100">
            <img src="${curso.imagen}" class="card-img-top" alt="${curso.titulo}">
            <div class="card-body">
              <h5 class="card-title">Curso: ${curso.titulo}</h5>
              <p class="card-text">Cantidad: ${curso.cantidad}</p>
              <p class="fw-bold">Precio: S/ ${curso.precio} x ${curso.cantidad} = S/ ${(curso.precio * curso.cantidad).toFixed(2)}</p>
              <div class="d-flex gap-2">
                <button class="btn btn-warning btn-sm" onclick="restarCurso('${curso.id}')">-1 unidad</button>
                <button class="btn btn-danger btn-sm" onclick="eliminarCurso('${curso.id}')">Eliminar todo</button>
              </div>
            </div>
          </div>
        `;
        carritoContainer.appendChild(card);
        total += curso.precio * curso.cantidad;
      });

      totalPrecio.textContent = `S/ ${total.toFixed(2)}`;
    }

    // Elimina una sola unidad del curso
    function restarCurso(id) {
      const index = carrito.findIndex(c => c.id === id);
      if (index !== -1) {
        carrito.splice(index, 1);
        localStorage.setItem("carrito", JSON.stringify(carrito));
        mostrarCarrito();
      }
    }

    // Elimina todo el curso del carrito
    function eliminarCurso(id) {
      carrito = carrito.filter(c => c.id !== id);
      localStorage.setItem("carrito", JSON.stringify(carrito));
      mostrarCarrito();
    }

    mostrarCarrito();
  </script>
</body>
</html>
